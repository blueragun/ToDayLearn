# 데이터 전처리



## 1. 데이터 생성, 데이터 정제



- 요약변수 : 수집된 정보를 객관적인 기준에 따라 요약한 것

- 파생변수 : 주관적 기준을 정의할 소지가 있는 것 / 선호도, 민감도 등

  

- 데이터 정제 

  -  결측값의 이해 : 기록누락, 미응답, 수집오류 등의 이유로 결측이 발생

    1. 결측값이 포함된 자료라도 나머지 변수의 값들은 의미있는 정보임

    2. 정보의 손실을 최소화 하도록 결측을 처리

    3. 결측값의 처리

       - 완전제거법 : 결측값이 하나 이상 포함된 자료를 제거

       - 정보의 손실로 결과가 왜곡될 수 있음

       - 평균 대처법
         - 결측값을 해당 변수의 나머지 값들의 평균으로 대체
         - 추정량의 표준오차가 과소추정되는 문제가 있음

    4. 핫덱대처법

       - 동일한 데이터 내에 결측값이 발생한 관찰치와 유사한 특성을 가진 다른 관찰치의 정보를 이용하여 대체

       - 모델을 이용해 처리하는 것 

         1. Regression imputation : 결측치가 없는 관찰치의 값들에서 어떤 함수를 추정해 대입하여 결측치를 추정하는 것 

         2. kNN imputation : 어떤 관찰치와 k개의 관찰치를 선택하고 관찰치 값의 평균을 구해 대입함

         

  - 이상값의 이해 : 다른 데이터와 동떨어진 것, 의미가 있는 값일 수도 있고, 단순 오류일 수 있음

    - 이상값의 탐지 

      1. 상자 그림 : |---[ __| __]---|  박스 플롯형

      2. 표준화 점수(Z-score) : x1, x2 등 숫자형 자료값들을 평균을 빼고  표준편차로 나눠 z로 구분하고 표준화 점수라 한다. 보통은 0, 1이 나오며 절대값(z)이 2, 3보다 큰 경우를 이상값으로 진단

    - 이상값 처리방법

      1. 이상값 제외 : 처리는 간단하나 정보의 손실 발생, 추정량 왜곡이 있을 수 있음

      2. 이상값 대체 : 이상값을 정상값 중 최대 또는 최소 등으로 대체하는 방식  // winsorization

      3. 변수변환 : 자료값 전체에 로그변환, 제곱근 변화 등을 적용  / 분표를 줄여 일정한 범위 안에 좁히는 것

  - 연속형 자료의 범주화

    - 변수구간화(binning) : 연속형 변수를 구간을 이용하여 범주화하는 과정  / 소득분위로 표현, 20대/30대 등

      1. 이상치 문제 완화 가능

      2. 결측치 처리 방법이 될 수 있음  / 관측되지 않은 결측값 자체를 범주화 할 수 있음
         - 소득이 낮아 기입하지 않는 사람들에 평균값을 넣게 되면 전체 값이 높아지는 결과가 만들어지게 되는 단점이 있다. 이럴때 범주화를 한다면 기입없음 등의 범주를 만들 수 있음

      3. 변수간 관계가 단순화되어 분석시 과적합을 방지할 수 있음, 결과 해석이 용이



## 2. 데이터 변환, 데이터 결합

1. 데이터 변환 : 자료 변환을 통해 자료의 해석을 쉽고 풍부하게 하기 위한 과정

    - 목적 

      1. 분포의 대칭화

      2. 산포를 비슷하게 하기 위하여

      3. 변수 간 관계를 단순하게 하기 위하여

    - 제곱근 변환 : 분포를 왼쪽으로 끌어당긴다  1, 4, 9 -> 1, 2, 3

    - 제곱변환 : 분포를 오른쪽으로 끌어당긴다 : 1, 4, 9 -> 1, 16, 81

      - 급상승 곡선의 경우 x축을 늘리던지(제곱/지수), y를 줄이던지(제곱근/로그) 하면 된다

        

    - 로그변환 : 분포를 왼쪽으로 끌어당긴다

    - 지수 변환 : 분포를 오른쪽으로 끌어당긴다
      - 올라가다 완만한 곡선의 경우 x를 줄이고(제곱근/로그) , y를 늘리고(제곱/지수)

    - 박스콕스 변환

      - 제곱근 유형의 변환을 일반화(제곱근/로그 변환)  : 갈수록 x축에 가까워 지는 
      - 제곱 유형의 변환을 일반화(제곱/지수 변환) : 갈수록 y축에 가까워 지는

      

2. 데이터 결합

   - 이너조인(inner join) : 교집합
     - 두 테이블에 키가 공통으로 존재하는 레코드만 결합

   - 풀 아우터 조인(full outer join) : 합집합
     - 두 테이블 중 어느 한쪽이라도 존재하는 키에 대한 레코드를 모두 결합
   - 레프트 조인(left join)
     - 왼쪽 테이블에 존재하는 키에 대한 레코드를 결합
   - 라이트 조인(right join)
     - 오른쪽 테이블에 존재하는 키에 대한 레코드를 결합